-- Detect the local player
local player = game:GetService("Players").LocalPlayer
local PlayerGui = player:WaitForChild("PlayerGui")

-- Create main UI container
local Freecam = Instance.new("ScreenGui")
Freecam.Parent = PlayerGui
Freecam.ResetOnSpawn = false  -- Ensures the UI stays after respawning

-- Function to add rounded corners
local function addRoundedCorners(instance, radius)
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, radius)
    UICorner.Parent = instance
end

-- Create primary frame (Main UI)
local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 457, 0, 233)
Frame.Position = UDim2.new(0.277, 0, 0.220, 0)
Frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40) -- Dark gray
Frame.Parent = Freecam
addRoundedCorners(Frame, 2)

-- Create side panel
local SidePanel = Instance.new("Frame")
SidePanel.Size = UDim2.new(0, 130, 0, 202)
SidePanel.Position = UDim2.new(0.022, 0, 0.044, 0)
SidePanel.BackgroundColor3 = Color3.fromRGB(60, 60, 60) -- Slightly lighter gray
SidePanel.Parent = Frame
addRoundedCorners(SidePanel, 10)

-- Create main panel
local MainPanel = Instance.new("Frame")
MainPanel.Size = UDim2.new(0, 274, 0, 202)
MainPanel.Position = UDim2.new(0.358, 0, 0.044, 0)
MainPanel.BackgroundColor3 = Color3.fromRGB(60, 60, 60) -- Even lighter gray
MainPanel.Parent = Frame
addRoundedCorners(MainPanel, 3)

-- Create title bar (draggable area)
local TitleBar = Instance.new("Frame")
TitleBar.Size = UDim2.new(1, 0, 0, 25)
TitleBar.Position = UDim2.new(0, 0, 0, -25) -- Position it right above the main UI
TitleBar.BackgroundColor3 = Color3.fromRGB(30, 30, 30) -- Darker gray
TitleBar.Parent = Frame
addRoundedCorners(TitleBar, 2)

-- Create "X" close button
local CloseButton = Instance.new("TextButton")
CloseButton.Size = UDim2.new(0, 20, 0, 20)
CloseButton.Position = UDim2.new(1, -25, 0, 2) -- Top-right corner
CloseButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50) -- Red button
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.Text = "X"
CloseButton.TextSize = 15
CloseButton.Parent = TitleBar
addRoundedCorners(CloseButton, 5)

-- Close UI when "X" is clicked
CloseButton.MouseButton1Click:Connect(function()
    Freecam:Destroy()
end)

-- Dragging functionality
local UIS = game:GetService("UserInputService")
local dragging, dragStart, startPos

TitleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = Frame.Position
    end
end)

TitleBar.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position - dragStart
        Frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

TitleBar.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = false
    end
end)

-- Create buttons function
local function createButton(parent, position, text)
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(0, 88, 0, 29)
    button.Position = position
    button.BackgroundColor3 = Color3.fromRGB(70, 70, 70) -- Button gray
    button.TextColor3 = Color3.fromRGB(255, 255, 255) -- White text
    button.Text = text
    button.Parent = parent
    addRoundedCorners(button, 6)
end

-- Add buttons with labels
createButton(Frame, UDim2.new(0.067, 0, 0.111, 0), "Option 1")
createButton(Frame, UDim2.new(0.067, 0, 0.270, 0), "Option 2")
createButton(Frame, UDim2.new(0.067, 0, 0.437, 0), "Option 3")
createButton(Frame, UDim2.new(0.067, 0, 0.596, 0), "Option 4")

createButton(Frame, UDim2.new(0.389, 0, 0.115, 0), "Action 1")
createButton(Frame, UDim2.new(0.389, 0, 0.270, 0), "Action 2")
createButton(Frame, UDim2.new(0.389, 0, 0.437, 0), "Action 3")
createButton(Frame, UDim2.new(0.389, 0, 0.600, 0), "Action 4")

createButton(Frame, UDim2.new(0.610, 0, 0.115, 0), "Mode 1")
createButton(Frame, UDim2.new(0.610, 0, 0.274, 0), "Mode 2")
createButton(Frame, UDim2.new(0.610, 0, 0.442, 0), "Mode 3")
createButton(Frame, UDim2.new(0.610, 0, 0.596, 0), "Mode 4")

-- Create text label
local TextLabel = Instance.new("TextLabel")
TextLabel.Size = UDim2.new(0, 109, 0, 25)
TextLabel.Position = UDim2.new(0, 0, -0.107, 0)
TextLabel.BackgroundColor3 = Color3.fromRGB(30, 30, 30) -- Label background
TextLabel.TextColor3 = Color3.fromRGB(255, 255, 255) -- White text
TextLabel.Text = "Title"
TextLabel.Parent = Frame
addRoundedCorners(TextLabel, 2)

-- Create scrolling frame
local ScrollingFrame = Instance.new("ScrollingFrame")
ScrollingFrame.Size = UDim2.new(0, 129, 0, 202)
ScrollingFrame.Position = UDim2.new(0.022, 0, 0.044, 0)
ScrollingFrame.BackgroundColor3 = Color3.fromRGB(90, 90, 90) -- Scrolling panel background
ScrollingFrame.Parent = Frame
addRoundedCorners(ScrollingFrame, 6)
